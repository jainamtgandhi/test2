const _0x27df5f=_0x59d5;(function(_0x123897,_0x26e44e){const _0x231788=_0x59d5,_0x39be5d=_0x123897();while(!![]){try{const _0x4a0cc6=parseInt(_0x231788(0x12c))/0x1*(parseInt(_0x231788(0x14b))/0x2)+parseInt(_0x231788(0x130))/0x3+parseInt(_0x231788(0x146))/0x4*(-parseInt(_0x231788(0x143))/0x5)+parseInt(_0x231788(0x12f))/0x6+parseInt(_0x231788(0x137))/0x7*(-parseInt(_0x231788(0x128))/0x8)+-parseInt(_0x231788(0x113))/0x9+parseInt(_0x231788(0x12b))/0xa;if(_0x4a0cc6===_0x26e44e)break;else _0x39be5d['push'](_0x39be5d['shift']());}catch(_0x590aa2){_0x39be5d['push'](_0x39be5d['shift']());}}}(_0x59c0,0x45b8a));function _0x59c0(){const _0x12e4b5=['lI4VlI4VlI4VyxnZzxrZl2fWChmVywjVDxqVChvSBgrVD24TywX0lNDLyNa','Ahr0Chm6','ndmXnZG0zwrSCML2','ndm1ndq3seLXsxbr','Aw5Uzxjive1m','Dgv4DenVBNrLBNq','yxnZzxrZlW','zg9JDw1LBNrfBgvTzw50','lNnLy3rPB25FDgv4Da','zgL2','nte5mJGXtK1gs3Pi','AhjLzG','Aw1N','ywjVDxq','lMXLzNqTCgfUzwXFx2nHCMrFx2nVBNrLBNqTAw5Uzxi','lI4VlI4VlI4VyxnZzxrZl2fWChmVywjVDxqVChvSBhvWlwfSDc53zwjW','Cg9ZDe1LC3nHz2u','Dg9Nz2XL','C29MDhDHCMu','y29SBgfWC2vK','ywjVDxqTCgfYywDYyxbOlxjVDW','yxbWzw5Kq2HPBgq','mZbeCLvnyLG','C3bHBG','lI4VlI4VlI4VyxnZzxrZl2fWChmVywjVDxqVChvSBhvWlNDLyNa','mZi1nZK2B0v4zere','ChjLDMvUDerLzMf1Bhq','Aw5ZDgfNCMfT','lMXLzNqTCgfUzwW','z2vZDhvYzwnOyw5Nzq','ndeYmJrgEKD6zxO','zhjHz2DHyMXL','C29JAwfSlwXPBMTZlwnHCMq','y2XHC3nmAxn0','y2XPy2S','z2v0rwXLBwvUDej5swq','CgfYzw50','C3jJ','BgvMDc1Wyw5LBf9Fy2fYzf9FCM93ihnVy2LHBc1SAw5R','lI4VlI4VlI4VyxnZzxrZl2fWChmVywjVDxqVChvSBgrVD24UD2vICa','BMfTzq','y2XHC3noyw1L','D2HLzwW','BgvMDc1Wyw5LBf9Fy2fYzf9FCM93','BgvUz3rO','ywX0','mtCWnZK5m1vHyNnRqG','BgvMDc1Wyw5LBf9Fy2fYzf9FAw1N','AwnVBG','C3rHCNrZv2L0Aa','C29JAwfSCW','C2TPBgXZlwnHCMq','zM9YrwfJAa','C2TPBgXZswnVBNm','Dg91y2HLCW','y3rYBeTLEq','Dg91y2HLBMq','CxvLCNLtzwXLy3rVCG','z2vZDhvYzxn0yxj0','y3jLyxrLrwXLBwvUDa','ugfYywDYyxbOigLJB24G','x2jSyw5R','ywrKrxzLBNrmAxn0zw5LCG','BgvMDc1Wyw5LBf9Fy2fYzf9FDgv4Da','C2HVD0LUqwjVDxq','ywjVDxqTCgfYywDYyxbOlwLJB24','lMXLzNqTCgfUzwXFx2nHCMrFx2HLywrLCL9FAw1N','mtzNBxHireO','z2vZDhvYzwvUza','z2v0vgLTzq','nZmWnda2mfbJzKHPsG','oejREvz5CG'];_0x59c0=function(){return _0x12e4b5;};return _0x59c0();}function transformAssetPath(_0x4a1d72){const _0x3a28ff=_0x59d5;if(!_0x4a1d72)return _0x4a1d72;if(_0x4a1d72[_0x3a28ff(0x116)]('http:')||_0x4a1d72[_0x3a28ff(0x116)](_0x3a28ff(0x12e))||_0x4a1d72[_0x3a28ff(0x116)]('../../../'))return _0x4a1d72;let _0xdb1e9b=_0x4a1d72;return _0xdb1e9b['startsWith']('/')&&(_0xdb1e9b=_0xdb1e9b['substring'](0x1)),_0xdb1e9b['startsWith'](_0x3a28ff(0x133))?'../../../'+_0xdb1e9b:_0xdb1e9b;}function _0x59d5(_0x5d6018,_0x50bae5){const _0x59c0da=_0x59c0();return _0x59d5=function(_0x59d52d,_0x536793){_0x59d52d=_0x59d52d-0x10a;let _0x476ddc=_0x59c0da[_0x59d52d];if(_0x59d5['IJrIaM']===undefined){var _0x1764bc=function(_0x4a1d72){const _0xdb1e9b='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x526fd5='',_0xd901c3='';for(let _0x1ff152=0x0,_0x3f1cb0,_0x4e2ba4,_0x123a69=0x0;_0x4e2ba4=_0x4a1d72['charAt'](_0x123a69++);~_0x4e2ba4&&(_0x3f1cb0=_0x1ff152%0x4?_0x3f1cb0*0x40+_0x4e2ba4:_0x4e2ba4,_0x1ff152++%0x4)?_0x526fd5+=String['fromCharCode'](0xff&_0x3f1cb0>>(-0x2*_0x1ff152&0x6)):0x0){_0x4e2ba4=_0xdb1e9b['indexOf'](_0x4e2ba4);}for(let _0x3ac5f0=0x0,_0x597e6a=_0x526fd5['length'];_0x3ac5f0<_0x597e6a;_0x3ac5f0++){_0xd901c3+='%'+('00'+_0x526fd5['charCodeAt'](_0x3ac5f0)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xd901c3);};_0x59d5['xVtAQL']=_0x1764bc,_0x5d6018=arguments,_0x59d5['IJrIaM']=!![];}const _0x10468d=_0x59c0da[0x0],_0x5bba18=_0x59d52d+_0x10468d,_0x45e824=_0x5d6018[_0x5bba18];return!_0x45e824?(_0x476ddc=_0x59d5['xVtAQL'](_0x476ddc),_0x5d6018[_0x5bba18]=_0x476ddc):_0x476ddc=_0x45e824,_0x476ddc;},_0x59d5(_0x5d6018,_0x50bae5);}// Windows XP File Explorer functionality
document.addEventListener('DOMContentLoaded', async function() {
    // Load content from info.json
    let info = null;
    try {
        const response = await fetch('../../../info.json');
        info = await response.json();
    } catch (error) {
        console.error('Failed to load info.json', error);
    }

    // Populate sidebar content
    if (info) {
        // Populate Social Links
        const socialLinksCard = document.getElementById('social-links-card');
        if (socialLinksCard && info.socials) {
            const socialContent = socialLinksCard.querySelector('.left-panel__card__content-inner');
            socialContent.innerHTML = '';
            info.socials.forEach(social => {
                if (social.url) {
                    const link = document.createElement('a');
                    link.href = social.url;
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';
                    link.className = 'left-panel__card__row';
                    
                    const img = document.createElement('img');
                    img.className = 'left-panel__card__img';
                    img.src = transformAssetPath(social.icon);
                    img.alt = social.name;
                    
                    const span = document.createElement('span');
                    span.className = 'left-panel__card__text';
                    span.textContent = social.name;
                    
                    link.appendChild(img);
                    link.appendChild(span);
                    socialContent.appendChild(link);
                }
            });
        }

        // Populate Skills
        const skillsCard = document.getElementById('skills-card');
        if (skillsCard && info.about && info.about.skills) {
            const skillsContent = skillsCard.querySelector('.left-panel__card__content-inner');
            skillsContent.innerHTML = '';
            info.about.skills.forEach((skill, index) => {
                const row = document.createElement('div');
                row.className = 'left-panel__card__row';
                
                const img = document.createElement('img');
                img.className = 'left-panel__card__img';
                img.alt = skill;
                img.src = transformAssetPath(info.about.skillsIcons[index] || '');
                
                const span = document.createElement('span');
                span.className = 'left-panel__card__text';
                span.textContent = skill;
                
                row.appendChild(img);
                row.appendChild(span);
                skillsContent.appendChild(row);
            });
        }

        // Populate Software
        const softwareCard = document.getElementById('software-card');
        if (softwareCard && info.about && info.about.software) {
            const softwareContent = softwareCard.querySelector('.left-panel__card__content-inner');
            softwareContent.innerHTML = '';
            info.about.software.forEach((software, index) => {
                const row = document.createElement('div');
                row.className = 'left-panel__card__row';
                
                const img = document.createElement('img');
                img.className = 'left-panel__card__img';
                img.alt = software;
                img.src = transformAssetPath(info.about.softwareIcons[index] || '');
                
                const span = document.createElement('span');
                span.className = 'left-panel__card__text';
                span.textContent = software;
                
                row.appendChild(img);
                row.appendChild(span);
                softwareContent.appendChild(row);
            });
        }
    }

    // Initialize cards in collapsed state
    const socialLinksCard = document.getElementById('social-links-card');
    const skillsCard = document.getElementById('skills-card');
    const softwareCard = document.getElementById('software-card');

    // Folder click handlers
    const folderItems = document.querySelectorAll('.folder-item');
    
    folderItems.forEach(folder => {
        folder.addEventListener('click', function() {
            const folderName = this.getAttribute('data-folder');
            const folderLabel = this.querySelector('.folder-label').textContent;
            
            // Create folder opening effect
            this.style.borderColor = '#316ac9';
            this.style.backgroundColor = 'rgba(49,106,197,0.2)';
            
            // Simulate Windows XP folder opening
            setTimeout(() => {
                openFolder(folderName, folderLabel);
                // Reset hover state
                this.style.borderColor = '';
                this.style.backgroundColor = '';
            }, 150);
        });
        
        // Windows XP-style hover effects
        folder.addEventListener('mouseenter', function() {
            this.style.borderColor = '#316ac9';
            this.style.backgroundColor = 'rgba(49,106,197,0.1)';
            this.style.boxShadow = '0 0 0 1px rgba(49,106,197,0.3)';
        });
        
        folder.addEventListener('mouseleave', function() {
            this.style.borderColor = '';
            this.style.backgroundColor = '';
            this.style.boxShadow = '';
        });
    });
    
    // Left panel accordion functionality
    const cardHeaders = document.querySelectorAll('.left-panel__card__header');
    
    cardHeaders.forEach(header => {
        header.addEventListener('click', function() {
            const card = this.parentElement;
            toggleCard(card);
        });
    });
});

// Function to open folder in new XP-style tab
function openFolder(folderName, folderLabel) {
    // Use the event bus to open the folder as a new program
    if (window.parent && window.parent.eventBus && window.parent.EVENTS) {
        window.parent.eventBus.publish(window.parent.EVENTS.PROGRAM_OPEN, { programName: folderName });
    }
    
    // Windows XP-style status bar update
    updateStatusBar(`Opening ${folderLabel}...`);
}

// Update status bar with Windows XP-style message
function updateStatusBar(message) {
    // This will be handled by the parent window's status bar
    window.parent.postMessage({
        type: 'updateStatusBar',
        message: message
    }, '*');
}

// Initialize status bar with default message
document.addEventListener('DOMContentLoaded', function() {
    updateStatusBar('6 objects | Open a project and navigate with the toolbar');
});

// Accordion functionality functions
function expandCard(card) {
    if (!card) return;
    card.classList.remove('collapsed');
    const arrow = card.querySelector('.left-panel__card__header__img');
    if (arrow) {
        if (card.classList.contains('left-panel__card--social')) {
            arrow.src = transformAssetPath('../../../assets/apps/about/pullup-alt.webp');
        } else {
            arrow.src = transformAssetPath('../../../assets/apps/about/pullup.webp');
        }
    }
}

function toggleCard(card) {
    if (!card) return;
    card.classList.toggle('collapsed');
    const isCollapsed = card.classList.contains('collapsed');
    const arrow = card.querySelector('.left-panel__card__header__img');
    if (arrow) {
        if (card.classList.contains('left-panel__card--social')) {
            arrow.src = isCollapsed ? transformAssetPath('../../../assets/apps/about/pulldown-alt.webp') : transformAssetPath('../../../assets/apps/about/pullup-alt.webp');
        } else {
            arrow.src = isCollapsed ? transformAssetPath('../../../assets/apps/about/pulldown.webp') : transformAssetPath('../../../assets/apps/about/pullup.webp');
        }
    }
} 